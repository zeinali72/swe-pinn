# configs/analytical_ntk_config.yaml
data_free: true
training:
  learning_rate: 0.00000005
  epochs: 20000
  batch_size: 512
  seed: 42
  clip_norm: 1.0
  lr_boundaries:
    1500000: 0.1
    3000000: 0.1

model:
  name: "NTK_MLP"
  width: 512
  depth: 6
  output_dim: 3
  ff_dims: 512
  fourier_scale: 10.0
  kernel_init: "glorot_uniform"
  bias_init: 0.0

domain:
  lx: 1200.0
  ly: 100.0
  t_final: 3600.0

sampling:
  n_points_pde: 10000
  n_points_ic: 10000
  n_points_bc_domain: 10000

validation_grid:
  n_points_val: 45000

ntk:
  enable: true
  update_freq: 100
  ema_alpha: 1.0

physics:
  u_const: 0.29
  n_manning: 0.03
  g: 9.81
  inflow: null

loss_weights:
  pde_weight: 1.0
  ic_weight: 1.0
  bc_weight: 1.0
  neg_h_weight: 1.0

plotting:
  nx_val: 101
  t_const_val: 1800.0
  y_const_plot: 0

device:
  dtype: "float32"
  early_stop_min_epochs: 4000
  early_stop_patience: 3000

numerics:
  eps: 1.0e-06

CONFIG_PATH: configs/analytical_ntk_config.yaml