{
   "name": "jax-ml-workspace",
   "containerName": "jax-ml-workspace",
   "shutdownAction": "none",

   "build": {
     "context": ".",
     "dockerfile": "Dockerfile",
     "args": { "NO_CACHE": "1" }
   },

   "envFile": [ "devcontainer.env" ],

   // --- START: ADD containerEnv ---
   "containerEnv": {
     "LD_LIBRARY_PATH": "/usr/local/cuda/lib64:${containerEnv:LD_LIBRARY_PATH}"
   },
   // --- END: ADD containerEnv ---


   "runArgs": [ "--gpus=all", "--restart", "unless-stopped" ],

   "mounts": [
     {
       "source": "/home/farzan/.gitconfig",
       "target": "/root/.gitconfig",
       "type": "bind"
     },
     {
       "source": "/home/farzan/.ssh",
       "target": "/tmp/.ssh-host",
       "type": "bind"
     }
   ],

   "postStartCommand": "mkdir -p /root/.ssh && cp -r /tmp/.ssh-host/. /root/.ssh/ && chmod 600 /root/.ssh/* || echo 'SSH setup skipped'",

   "containerUser": "root",

   "customizations": {
     "vscode": {
       "extensions": [
         "ms-python.python",
         "ms-python.vscode-pylance",
         "ms-toolsai.jupyter",
         "ms-toolsai.jupyter-renderers"
       ]
     }
   }
 }